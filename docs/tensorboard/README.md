# TensorBoard: Руководство по использованию

---

## Введение
TensorBoard — это инструмент для визуализации и мониторинга процесса обучения моделей машинного обучения. В этом руководстве мы рассмотрим, как использовать TensorBoard для отслеживания прогресса обучения модели, с акцентом на метрику `g/total`.

---

## Как использовать TensorBoard

### 1. Запуск TensorBoard
1. Откройте TensorBoard, запустив файл `run-tensorboard.bat` или введите следующую команду в терминале:
   ```
   tensorboard --logdir=replace/with/your/logs/folder/path
   ```
2. После запуска TensorBoard откройте веб-браузер и перейдите по адресу `http://localhost:6006` (или по адресу, указанному в терминале).

### 2. Настройка TensorBoard
1. Перейдите на вкладку "Scalars" (Скаляры).
2. Найдите метрику `g/total` в верхней части страницы, чтобы отслеживать прогресс обучения.

### Настройки
- Установите сглаживание (smoothing) на `0.950` или `0.987` для лучшего отображения графика.
- Нажмите на значок шестеренки (⚙️), чтобы включить опцию автоматической перезагрузки данных каждые 30 секунд.
- Под каждым графиком есть три кнопки:
  1. Первая — для увеличения размера графика.
  2. Вторая — для отключения оси Y.
  3. Третья — для подгонки данных под график.
- Снимите галочку с опции **"ignore outliers in chart scaling"**.

### Низшая точка
Низшая точка — это момент, когда график достигает такой низкой точки, которая больше не повторяется. Во время обучения могут быть несколько таких точек, которые нужно протестировать, чтобы найти оптимальную модель и предотвратить её переобучение. Чтобы выбрать нужную точку, обратите внимание на количество шагов (steps) в этой точке. Затем найдите эпохи (epochs) с этим или ближайшим шагом в сохранённых точках.

---

## Дополнительная информация

### Мониторинг других метрик
Помимо `loss/g/total`, важно отслеживать следующие графики:
- `loss/g/mel`: Показывает точность модели в воспроизведении мел-спектрограммы из вашего датасета.
- `loss/g/kl`: Отражает расхождение Кульбака-Лейблера (KL divergence).
- `loss/d/total`: Показывает, насколько хорошо дискриминатор различает реальные и сгенерированные данные.

Если какие-либо из этих значений растут и не уменьшаются, это может указывать на переобучение. В начале обучения нормально, что `d/total` увеличивается, а `g/total` уменьшается, но со временем они должны стабилизироваться и уменьшаться вместе.

### Термины потерь
- **Discriminator Loss (loss_disc)**: Показывает, насколько хорошо дискриминатор различает реальные и сгенерированные данные.
- **Generator Loss (loss_gen)**: Показывает, насколько хорошо генератор обманывает дискриминатор.
- **Feature Matching Loss (loss_fm)**: Поощряет генератор создавать данные с похожими промежуточными представлениями.
- **Mel Spectrogram Loss (loss_mel)**: Сравнивает мел-спектрограммы реальных и сгенерированных данных.
- **KL Divergence Loss (loss_kl)**: Поощряет генератор создавать данные с похожим распределением латентных переменных.

### Дополнительные метрики
- **Scalars**:
  - `loss/g/total`: Общая потеря генератора.
  - `loss/d/total`: Общая потеря дискриминатора.
  - `learning_rate`: Текущая скорость обучения.
  - `grad_norm_d`: Норма градиента для дискриминатора.
  - `grad_norm_g`: Норма градиента для генератора.
  - `loss/g/fm`: Потеря сопоставления признаков.
  - `loss/g/mel`: Потеря мел-спектрограммы.
  - `loss/g/kl`: Потеря расхождения Кульбака-Лейблера.

- **Images**:
  - `slice/mel_org`: Визуализация мел-спектрограммы целевого аудиосегмента.
  - `slice/mel_gen`: Визуализация мел-спектрограммы сгенерированного аудиосегмента.
  - `all/mel`: Визуализация мел-спектрограммы всего целевого аудио.

### Интерпретация
- **Общий тренд**: Ищите уменьшение общей потери генератора (`loss/g/total`) и стабильность или увеличение потери дискриминатора (`loss/d/total`).
- **Норма градиента**: Отслеживайте нормы градиентов, чтобы избежать их чрезмерного увеличения или уменьшения.
- **Компоненты потерь**: Анализируйте отдельные компоненты потерь, чтобы понять, как работают различные аспекты модели.
- **Мел-спектрограммы**: Сравните изображения мел-спектрограмм, чтобы визуально оценить качество сгенерированного аудио.

---