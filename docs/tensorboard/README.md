# TensorBoard: Руководство по использованию

TensorBoard — это инструмент для визуализации и мониторинга процесса обучения моделей машинного обучения. В этом руководстве мы рассмотрим, как использовать TensorBoard для отслеживания прогресса обучения модели, с акцентом на метрику `g/total`.

## Как использовать TensorBoard

1. **Запуск TensorBoard**:
   - Откройте TensorBoard, запустив файл `run-tensorboard.bat` или выполнив следующую команду в терминале:
     ```sh
     tensorboard --logdir=replace/with/your/logs/folder/path
     ```

2. **Открытие TensorBoard в браузере**:
   - После запуска TensorBoard откройте веб-браузер и перейдите по адресу `http://localhost:6006` (или по адресу, указанному в вашем терминале).

3. **Переход на вкладку "Scalars"**:
   - В TensorBoard нажмите на вкладку "Scalars".

4. **Поиск метрики `g/total`**:
   - Найдите метрику `g/total` в верхней части списка для мониторинга прогресса обучения.

## Настройки TensorBoard

- **Сглаживание**: Установите сглаживание на 0.950 или 0.987 для лучшего отображения графика.
- **Автоматическое обновление данных**: Нажмите на иконку шестеренки и выберите опцию для автоматического обновления данных каждые 30 секунд.
- **Настройки графика**: Под каждым графиком есть три кнопки:
  - Первая кнопка увеличивает график до полного размера.
  - Вторая кнопка отключает ось Y.
  - Третья кнопка настраивает данные на графике.
- **Игнорирование выбросов**: Снимите галочку с опции "Игнорировать выбросы при масштабировании графика".

## Найти низшую точку

Низшая точка на графике — это момент, когда значение метрики падает до минимального уровня и больше не поднимается. Во время обучения могут быть несколько низких точек, которые нужно протестировать, чтобы найти оптимальную модель и предотвратить её переобучение. Для этого:

1. Найдите низшую точку на графике и посмотрите, сколько шагов было выполнено.
2. Зная количество шагов, найдите соответствующие эпохи в сохраненных точках в вашем CMD или Colab ноутбуке.

## Дополнительная информация

### Метрики для мониторинга

Помимо метрики `loss/g/total`, необходимо отслеживать следующие метрики:
- `loss/g/mel`
- `loss/g/kl`
- `loss/d/total`

Если любая из этих метрик начинает расти и не снижается, это указывает на переобучение модели. В начале обучения нормально, если `d/total` растет, а `g/total` падает, но со временем они должны стабилизироваться и оба начинают снижаться.

### Потери (Loss Terms)

Потери предоставляют ценную обратную связь во время обучения GAN, помогая улучшить качество и реалистичность генерируемых данных.

#### Потери дискриминатора (Discriminator Loss)

Измеряет способность дискриминатора различать реальные и синтетические данные. Снижение этой потери указывает на то, что дискриминатор становится лучше в различении данных.

#### Потери генератора (Generator Loss)

Измеряет способность генератора создавать данные, которые неотличимы от реальных. Снижение этой потери указывает на то, что генератор успешно учится создавать реалистичные данные.

#### Потери соответствия признаков (Feature Matching Loss)

Поощряет генератор создавать данные с похожими промежуточными признаками, как у реальных данных.

#### Потери мел-спектрограммы (Mel Spectrogram Loss)

Сравнивает мел-спектрограммы реальных и синтетических данных, что важно для задач генерации аудио.

#### Потери KL-дивергенции (KL Divergence Loss)

Поощряет генератор создавать данные с похожим распределением латентных переменных, как у реальных данных.

## Дополнительная информация о TensorBoard

### Scalars

- `loss/g/total`: Общая потеря генератора.
- `loss/d/total`: Общая потеря дискриминатора.
- `learning_rate`: Текущая скорость обучения оптимизаторов.
- `grad_norm_d`: Норма градиента для дискриминатора.
- `grad_norm_g`: Норма градиента для генератора.
- `loss/g/fm`: Потеря соответствия признаков.
- `loss/g/mel`: Потеря мел-спектрограммы.
- `loss/g/kl`: Потеря KL-дивергенции.
- `loss/g/{i}`: Индивидуальные потери генератора для каждого выхода дискриминатора.
- `loss/d_r/{i}`: Индивидуальные потери дискриминатора для реального аудио.
- `loss/d_g/{i}`: Индивидуальные потери дискриминатора для генерируемого аудио.

### Images

- `slice/mel_org`: Визуализация мел-спектрограммы целевого аудио сегмента.
- `slice/mel_gen`: Визуализация мел-спектрограммы генерируемого аудио сегмента.
- `all/mel`: Визуализация мел-спектрограммы всего целевого аудио.

### Интерпретация

- **Общая тенденция**: Ищите снижение общей потери генератора (`loss/g/total`) и относительно стабильное или растущее значение общей потери дискриминатора (`loss/d/total`) со временем.
- **Норма градиента**: Следите за нормами градиентов, чтобы они не становились чрезмерно большими или малыми.
- **Компоненты потерь**: Анализируйте индивидуальные компоненты потерь (например, `loss/g/mel`, `loss/g/kl`), чтобы понять, как работают конкретные аспекты модели.
- **Мел-спектрограммы**: Сравнивайте изображения мел-спектрограмм (`slice/mel_org` и `slice/mel_gen`), чтобы визуально оценить качество генерируемого аудио.
